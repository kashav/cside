{"version":3,"file":"main.abfb05a60314859069ef.js","mappings":";mBAAA,SAASA,EAAyCC,EAAMC,GAChC,WAAlBD,EAAKE,SACPD,EAAoBD,GACS,OAApBA,EAAKG,YACdH,EAAKG,WAAWC,SAAQ,SAACC,GACvBN,EAAyCM,EAAWJ,EACtD,GAEJ,oPCPAK,EAAA,kBAAAC,CAAA,MAAAC,EAAAD,EAAA,GAAAE,EAAAC,OAAAC,UAAAC,EAAAH,EAAAI,eAAAC,EAAAJ,OAAAK,gBAAA,SAAAP,EAAAD,EAAAE,GAAAD,EAAAD,GAAAE,EAAAO,KAAA,EAAAC,EAAA,mBAAAC,OAAAA,OAAA,GAAAC,EAAAF,EAAAG,UAAA,aAAAC,EAAAJ,EAAAK,eAAA,kBAAAC,EAAAN,EAAAO,aAAA,yBAAAC,EAAAjB,EAAAD,EAAAE,GAAA,OAAAC,OAAAK,eAAAP,EAAAD,EAAA,CAAAS,MAAAP,EAAAiB,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAApB,EAAAD,EAAA,KAAAkB,EAAA,aAAAjB,GAAAiB,EAAA,SAAAjB,EAAAD,EAAAE,GAAA,OAAAD,EAAAD,GAAAE,CAAA,WAAAoB,EAAArB,EAAAD,EAAAE,EAAAG,GAAA,IAAAK,EAAAV,GAAAA,EAAAI,qBAAAmB,EAAAvB,EAAAuB,EAAAX,EAAAT,OAAAqB,OAAAd,EAAAN,WAAAU,EAAA,IAAAW,EAAApB,GAAA,WAAAE,EAAAK,EAAA,WAAAH,MAAAiB,EAAAzB,EAAAC,EAAAY,KAAAF,CAAA,UAAAe,EAAA1B,EAAAD,EAAAE,GAAA,WAAA0B,KAAA,SAAAC,IAAA5B,EAAA6B,KAAA9B,EAAAE,GAAA,OAAAD,GAAA,OAAA2B,KAAA,QAAAC,IAAA5B,EAAA,EAAAD,EAAAsB,KAAAA,EAAA,IAAAS,EAAA,iBAAAC,EAAA,iBAAAC,EAAA,YAAAC,EAAA,YAAAC,EAAA,YAAAZ,IAAA,UAAAa,IAAA,UAAAC,IAAA,KAAAC,EAAA,GAAApB,EAAAoB,EAAA1B,GAAA,8BAAA2B,EAAApC,OAAAqC,eAAAC,EAAAF,GAAAA,EAAAA,EAAAG,EAAA,MAAAD,GAAAA,IAAAvC,GAAAG,EAAAyB,KAAAW,EAAA7B,KAAA0B,EAAAG,GAAA,IAAAE,EAAAN,EAAAjC,UAAAmB,EAAAnB,UAAAD,OAAAqB,OAAAc,GAAA,SAAAM,EAAA3C,GAAA,0BAAAJ,SAAA,SAAAG,GAAAkB,EAAAjB,EAAAD,GAAA,SAAAC,GAAA,YAAA4C,QAAA7C,EAAAC,EAAA,gBAAA6C,EAAA7C,EAAAD,GAAA,SAAA+C,EAAA7C,EAAAK,EAAAG,EAAAE,GAAA,IAAAE,EAAAa,EAAA1B,EAAAC,GAAAD,EAAAM,GAAA,aAAAO,EAAAc,KAAA,KAAAZ,EAAAF,EAAAe,IAAAE,EAAAf,EAAAP,MAAA,OAAAsB,GAAA,UAAAiB,EAAAjB,IAAA1B,EAAAyB,KAAAC,EAAA,WAAA/B,EAAAiD,QAAAlB,EAAAmB,SAAAC,MAAA,SAAAlD,GAAA8C,EAAA,OAAA9C,EAAAS,EAAAE,EAAA,aAAAX,GAAA8C,EAAA,QAAA9C,EAAAS,EAAAE,EAAA,IAAAZ,EAAAiD,QAAAlB,GAAAoB,MAAA,SAAAlD,GAAAe,EAAAP,MAAAR,EAAAS,EAAAM,EAAA,aAAAf,GAAA,OAAA8C,EAAA,QAAA9C,EAAAS,EAAAE,EAAA,IAAAA,EAAAE,EAAAe,IAAA,KAAA3B,EAAAK,EAAA,gBAAAE,MAAA,SAAAR,EAAAI,GAAA,SAAA+C,IAAA,WAAApD,GAAA,SAAAA,EAAAE,GAAA6C,EAAA9C,EAAAI,EAAAL,EAAAE,EAAA,WAAAA,EAAAA,EAAAA,EAAAiD,KAAAC,EAAAA,GAAAA,GAAA,aAAA1B,EAAA1B,EAAAE,EAAAG,GAAA,IAAAE,EAAAwB,EAAA,gBAAArB,EAAAE,GAAA,GAAAL,IAAA0B,EAAA,MAAAoB,MAAA,mCAAA9C,IAAA2B,EAAA,cAAAxB,EAAA,MAAAE,EAAA,OAAAH,MAAAR,EAAAqD,MAAA,OAAAjD,EAAAkD,OAAA7C,EAAAL,EAAAwB,IAAAjB,IAAA,KAAAE,EAAAT,EAAAmD,SAAA,GAAA1C,EAAA,KAAAE,EAAAyC,EAAA3C,EAAAT,GAAA,GAAAW,EAAA,IAAAA,IAAAmB,EAAA,gBAAAnB,CAAA,cAAAX,EAAAkD,OAAAlD,EAAAqD,KAAArD,EAAAsD,MAAAtD,EAAAwB,SAAA,aAAAxB,EAAAkD,OAAA,IAAAhD,IAAAwB,EAAA,MAAAxB,EAAA2B,EAAA7B,EAAAwB,IAAAxB,EAAAuD,kBAAAvD,EAAAwB,IAAA,gBAAAxB,EAAAkD,QAAAlD,EAAAwD,OAAA,SAAAxD,EAAAwB,KAAAtB,EAAA0B,EAAA,IAAAK,EAAAX,EAAA3B,EAAAE,EAAAG,GAAA,cAAAiC,EAAAV,KAAA,IAAArB,EAAAF,EAAAiD,KAAApB,EAAAF,EAAAM,EAAAT,MAAAM,EAAA,gBAAA1B,MAAA6B,EAAAT,IAAAyB,KAAAjD,EAAAiD,KAAA,WAAAhB,EAAAV,OAAArB,EAAA2B,EAAA7B,EAAAkD,OAAA,QAAAlD,EAAAwB,IAAAS,EAAAT,IAAA,YAAA4B,EAAAzD,EAAAE,GAAA,IAAAG,EAAAH,EAAAqD,OAAAhD,EAAAP,EAAAa,SAAAR,GAAA,GAAAE,IAAAN,EAAA,OAAAC,EAAAsD,SAAA,eAAAnD,GAAAL,EAAAa,SAAA,SAAAX,EAAAqD,OAAA,SAAArD,EAAA2B,IAAA5B,EAAAwD,EAAAzD,EAAAE,GAAA,UAAAA,EAAAqD,SAAA,WAAAlD,IAAAH,EAAAqD,OAAA,QAAArD,EAAA2B,IAAA,IAAAiC,UAAA,oCAAAzD,EAAA,aAAA8B,EAAA,IAAAzB,EAAAiB,EAAApB,EAAAP,EAAAa,SAAAX,EAAA2B,KAAA,aAAAnB,EAAAkB,KAAA,OAAA1B,EAAAqD,OAAA,QAAArD,EAAA2B,IAAAnB,EAAAmB,IAAA3B,EAAAsD,SAAA,KAAArB,EAAA,IAAAvB,EAAAF,EAAAmB,IAAA,OAAAjB,EAAAA,EAAA0C,MAAApD,EAAAF,EAAA+D,YAAAnD,EAAAH,MAAAP,EAAA8D,KAAAhE,EAAAiE,QAAA,WAAA/D,EAAAqD,SAAArD,EAAAqD,OAAA,OAAArD,EAAA2B,IAAA5B,GAAAC,EAAAsD,SAAA,KAAArB,GAAAvB,GAAAV,EAAAqD,OAAA,QAAArD,EAAA2B,IAAA,IAAAiC,UAAA,oCAAA5D,EAAAsD,SAAA,KAAArB,EAAA,UAAA+B,EAAAjE,GAAA,IAAAD,EAAA,CAAAmE,OAAAlE,EAAA,SAAAA,IAAAD,EAAAoE,SAAAnE,EAAA,SAAAA,IAAAD,EAAAqE,WAAApE,EAAA,GAAAD,EAAAsE,SAAArE,EAAA,SAAAsE,WAAAC,KAAAxE,EAAA,UAAAyE,EAAAxE,GAAA,IAAAD,EAAAC,EAAAyE,YAAA,GAAA1E,EAAA4B,KAAA,gBAAA5B,EAAA6B,IAAA5B,EAAAyE,WAAA1E,CAAA,UAAAyB,EAAAxB,GAAA,KAAAsE,WAAA,EAAAJ,OAAA,SAAAlE,EAAAJ,QAAAqE,EAAA,WAAAS,OAAA,YAAAjC,EAAA1C,GAAA,GAAAA,GAAA,KAAAA,EAAA,KAAAE,EAAAF,EAAAY,GAAA,GAAAV,EAAA,OAAAA,EAAA4B,KAAA9B,GAAA,sBAAAA,EAAAgE,KAAA,OAAAhE,EAAA,IAAA4E,MAAA5E,EAAA6E,QAAA,KAAAtE,GAAA,EAAAG,EAAA,SAAAsD,IAAA,OAAAzD,EAAAP,EAAA6E,QAAA,GAAAxE,EAAAyB,KAAA9B,EAAAO,GAAA,OAAAyD,EAAAvD,MAAAT,EAAAO,GAAAyD,EAAAV,MAAA,EAAAU,EAAA,OAAAA,EAAAvD,MAAAR,EAAA+D,EAAAV,MAAA,EAAAU,CAAA,SAAAtD,EAAAsD,KAAAtD,CAAA,YAAAoD,UAAAd,EAAAhD,GAAA,2BAAAoC,EAAAhC,UAAAiC,EAAA9B,EAAAoC,EAAA,eAAAlC,MAAA4B,EAAAjB,cAAA,IAAAb,EAAA8B,EAAA,eAAA5B,MAAA2B,EAAAhB,cAAA,IAAAgB,EAAA0C,YAAA5D,EAAAmB,EAAArB,EAAA,qBAAAhB,EAAA+E,oBAAA,SAAA9E,GAAA,IAAAD,EAAA,mBAAAC,GAAAA,EAAA+E,YAAA,QAAAhF,IAAAA,IAAAoC,GAAA,uBAAApC,EAAA8E,aAAA9E,EAAAiF,MAAA,EAAAjF,EAAAkF,KAAA,SAAAjF,GAAA,OAAAE,OAAAgF,eAAAhF,OAAAgF,eAAAlF,EAAAoC,IAAApC,EAAAmF,UAAA/C,EAAAnB,EAAAjB,EAAAe,EAAA,sBAAAf,EAAAG,UAAAD,OAAAqB,OAAAmB,GAAA1C,CAAA,EAAAD,EAAAqF,MAAA,SAAApF,GAAA,OAAAiD,QAAAjD,EAAA,EAAA2C,EAAAE,EAAA1C,WAAAc,EAAA4B,EAAA1C,UAAAU,GAAA,0BAAAd,EAAA8C,cAAAA,EAAA9C,EAAAsF,MAAA,SAAArF,EAAAC,EAAAG,EAAAE,EAAAG,QAAA,IAAAA,IAAAA,EAAA6E,SAAA,IAAA3E,EAAA,IAAAkC,EAAAxB,EAAArB,EAAAC,EAAAG,EAAAE,GAAAG,GAAA,OAAAV,EAAA+E,oBAAA7E,GAAAU,EAAAA,EAAAoD,OAAAb,MAAA,SAAAlD,GAAA,OAAAA,EAAAqD,KAAArD,EAAAQ,MAAAG,EAAAoD,MAAA,KAAApB,EAAAD,GAAAzB,EAAAyB,EAAA3B,EAAA,aAAAE,EAAAyB,EAAA/B,GAAA,0BAAAM,EAAAyB,EAAA,qDAAA3C,EAAAwF,KAAA,SAAAvF,GAAA,IAAAD,EAAAG,OAAAF,GAAAC,EAAA,WAAAG,KAAAL,EAAAE,EAAAsE,KAAAnE,GAAA,OAAAH,EAAAuF,UAAA,SAAAzB,IAAA,KAAA9D,EAAA2E,QAAA,KAAA5E,EAAAC,EAAAwF,MAAA,GAAAzF,KAAAD,EAAA,OAAAgE,EAAAvD,MAAAR,EAAA+D,EAAAV,MAAA,EAAAU,CAAA,QAAAA,EAAAV,MAAA,EAAAU,CAAA,GAAAhE,EAAA0C,OAAAA,EAAAjB,EAAArB,UAAA,CAAA4E,YAAAvD,EAAAkD,MAAA,SAAA3E,GAAA,QAAA2F,KAAA,OAAA3B,KAAA,OAAAN,KAAA,KAAAC,MAAA1D,EAAA,KAAAqD,MAAA,OAAAE,SAAA,UAAAD,OAAA,YAAA1B,IAAA5B,EAAA,KAAAsE,WAAA1E,QAAA4E,IAAAzE,EAAA,QAAAE,KAAA,WAAAA,EAAA0F,OAAA,IAAAvF,EAAAyB,KAAA,KAAA5B,KAAA0E,OAAA1E,EAAA2F,MAAA,WAAA3F,GAAAD,EAAA,EAAA6F,KAAA,gBAAAxC,MAAA,MAAArD,EAAA,KAAAsE,WAAA,GAAAG,WAAA,aAAAzE,EAAA2B,KAAA,MAAA3B,EAAA4B,IAAA,YAAAkE,IAAA,EAAAnC,kBAAA,SAAA5D,GAAA,QAAAsD,KAAA,MAAAtD,EAAA,IAAAE,EAAA,cAAA8F,EAAA3F,EAAAE,GAAA,OAAAK,EAAAgB,KAAA,QAAAhB,EAAAiB,IAAA7B,EAAAE,EAAA8D,KAAA3D,EAAAE,IAAAL,EAAAqD,OAAA,OAAArD,EAAA2B,IAAA5B,KAAAM,CAAA,SAAAA,EAAA,KAAAgE,WAAAM,OAAA,EAAAtE,GAAA,IAAAA,EAAA,KAAAG,EAAA,KAAA6D,WAAAhE,GAAAK,EAAAF,EAAAgE,WAAA,YAAAhE,EAAAyD,OAAA,OAAA6B,EAAA,UAAAtF,EAAAyD,QAAA,KAAAwB,KAAA,KAAA7E,EAAAT,EAAAyB,KAAApB,EAAA,YAAAM,EAAAX,EAAAyB,KAAApB,EAAA,iBAAAI,GAAAE,EAAA,SAAA2E,KAAAjF,EAAA0D,SAAA,OAAA4B,EAAAtF,EAAA0D,UAAA,WAAAuB,KAAAjF,EAAA2D,WAAA,OAAA2B,EAAAtF,EAAA2D,WAAA,SAAAvD,GAAA,QAAA6E,KAAAjF,EAAA0D,SAAA,OAAA4B,EAAAtF,EAAA0D,UAAA,YAAApD,EAAA,MAAAqC,MAAA,kDAAAsC,KAAAjF,EAAA2D,WAAA,OAAA2B,EAAAtF,EAAA2D,WAAA,KAAAR,OAAA,SAAA5D,EAAAD,GAAA,QAAAE,EAAA,KAAAqE,WAAAM,OAAA,EAAA3E,GAAA,IAAAA,EAAA,KAAAK,EAAA,KAAAgE,WAAArE,GAAA,GAAAK,EAAA4D,QAAA,KAAAwB,MAAAtF,EAAAyB,KAAAvB,EAAA,oBAAAoF,KAAApF,EAAA8D,WAAA,KAAA3D,EAAAH,EAAA,OAAAG,IAAA,UAAAT,GAAA,aAAAA,IAAAS,EAAAyD,QAAAnE,GAAAA,GAAAU,EAAA2D,aAAA3D,EAAA,UAAAE,EAAAF,EAAAA,EAAAgE,WAAA,UAAA9D,EAAAgB,KAAA3B,EAAAW,EAAAiB,IAAA7B,EAAAU,GAAA,KAAA6C,OAAA,YAAAS,KAAAtD,EAAA2D,WAAAlC,GAAA,KAAA8D,SAAArF,EAAA,EAAAqF,SAAA,SAAAhG,EAAAD,GAAA,aAAAC,EAAA2B,KAAA,MAAA3B,EAAA4B,IAAA,gBAAA5B,EAAA2B,MAAA,aAAA3B,EAAA2B,KAAA,KAAAoC,KAAA/D,EAAA4B,IAAA,WAAA5B,EAAA2B,MAAA,KAAAmE,KAAA,KAAAlE,IAAA5B,EAAA4B,IAAA,KAAA0B,OAAA,cAAAS,KAAA,kBAAA/D,EAAA2B,MAAA5B,IAAA,KAAAgE,KAAAhE,GAAAmC,CAAA,EAAA+D,OAAA,SAAAjG,GAAA,QAAAD,EAAA,KAAAuE,WAAAM,OAAA,EAAA7E,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAqE,WAAAvE,GAAA,GAAAE,EAAAmE,aAAApE,EAAA,YAAAgG,SAAA/F,EAAAwE,WAAAxE,EAAAoE,UAAAG,EAAAvE,GAAAiC,CAAA,kBAAAlC,GAAA,QAAAD,EAAA,KAAAuE,WAAAM,OAAA,EAAA7E,GAAA,IAAAA,EAAA,KAAAE,EAAA,KAAAqE,WAAAvE,GAAA,GAAAE,EAAAiE,SAAAlE,EAAA,KAAAI,EAAAH,EAAAwE,WAAA,aAAArE,EAAAuB,KAAA,KAAArB,EAAAF,EAAAwB,IAAA4C,EAAAvE,EAAA,QAAAK,CAAA,QAAA8C,MAAA,0BAAA8C,cAAA,SAAAnG,EAAAE,EAAAG,GAAA,YAAAmD,SAAA,CAAA3C,SAAA6B,EAAA1C,GAAA+D,WAAA7D,EAAA+D,QAAA5D,GAAA,cAAAkD,SAAA,KAAA1B,IAAA5B,GAAAkC,CAAA,GAAAnC,CAAA,UAAAoG,EAAA/F,EAAAJ,EAAAD,EAAAE,EAAAK,EAAAK,EAAAE,GAAA,QAAAJ,EAAAL,EAAAO,GAAAE,GAAAE,EAAAN,EAAAD,KAAA,OAAAJ,GAAA,YAAAL,EAAAK,EAAA,CAAAK,EAAA4C,KAAArD,EAAAe,GAAAuE,QAAAtC,QAAAjC,GAAAmC,KAAAjD,EAAAK,EAAA,CACA,ICSQ8F,ECDAC,EHAwCC,EACxCC,EAEAC,EEFAJ,EAAqBlG,OAAOuG,yBAChCC,iBAAiBvG,UACjB,SAGFD,OAAOK,eAAemG,iBAAiBvG,UAAW,QAAS,CACzDwG,IAAK,WACH,IAAMnG,EAAQ4F,EAAmBO,IAAI9E,KAAK+E,MAI1C,OAtBN,SAAqCC,EAAcrG,GACjDsG,QAAQC,MAAM,CACZpF,KAAM,6BACNqF,QAASH,EAAaI,UACtBC,aAAc1G,GAElB,CAeM2G,CAA4BP,KAAMpG,GAC3BA,CACT,EACA4G,IAAK,SAAUC,GACbjB,EAAmBgB,IAAIvF,KAAK+E,KAAMS,EACpC,IFhB4Cf,ECHf,eANjClG,EAMiCkH,GANjClH,EAMiCN,IAAAmF,MAAC,SAAAsC,EAAOC,GAAU,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAnI,IAAAuB,MAAA,SAAA6G,GAAA,cAAAA,EAAAxC,KAAAwC,EAAAnE,MAAA,OAMU,GALrD2D,EAAgB,KAChBC,EAAM,KACNC,GAAoB,EACpBC,GAAiB,IAEfC,EAAUN,EAAWW,WAAWC,aAAa,QACtC,CAAFF,EAAAnE,KAAA,SAGT,OAFA4D,EAAMG,EAAQtH,MAEd0H,EAAAnE,KAAA,EACuBsE,MAAMV,GAAI,OAAnB,OAARI,EAAQG,EAAAzE,KAAAyE,EAAAnE,KAAG,GACKgE,EAASO,OAAM,QAArCZ,EAAaQ,EAAAzE,KAIbmE,IAAsBD,EAAIY,MAAM,0CAA0CL,EAAAnE,KAAA,iBAC5C,QAAzB0D,EAAID,EAAW7H,kBAAU,IAAA8H,GAAK,QAALA,EAArBA,EAAwB,UAAE,IAAAA,GAA1BA,EAA4Be,OACrCd,EAAgBF,EAAW7H,WAAW,GAAG6I,KACzCX,GAAiB,GAClB,QAGD,GAAIH,EAAe,CACjBZ,QAAQC,MAAM,CACZpF,KAAM,4BACNgG,IAAAA,EACAE,eAAAA,EACAD,kBAAAA,EACAF,cAAAA,IAGIM,EAAUS,KAAKC,UAAU,CAC7BC,KAAMC,OAAOC,SAASF,KACtBhB,IAAKA,GAAO,gBACZmB,OAAQpB,IAEJO,EAAO,IAAIc,KAAK,CAACf,GAAU,CAAErG,KAAM,qBAEzC,IACEqH,UAAUC,WA7CF,2CA6CsBhB,EAChC,CAAE,MAAOiB,GACPpC,QAAQoC,MAAMA,EAChB,CACF,CAAC,yBAAAhB,EAAArC,OAAA,GAAA0B,EAAA,IAlDL,eAAAvH,EAAA,KAAAD,EAAAoJ,UAAA,WAAA7D,SAAA,SAAArF,EAAAK,GAAA,IAAAK,EAAAP,EAAAgJ,MAAApJ,EAAAD,GAAA,SAAAsJ,EAAAjJ,GAAA+F,EAAAxF,EAAAV,EAAAK,EAAA+I,EAAAC,EAAA,OAAAlJ,EAAA,UAAAkJ,EAAAlJ,GAAA+F,EAAAxF,EAAAV,EAAAK,EAAA+I,EAAAC,EAAA,QAAAlJ,EAAA,CAAAiJ,OAAA,QAmDG,gBAAAE,GAAA,OAAAjC,EAAA8B,MAAA,KAAAD,UAAA,EA7C8B,GDIzB5C,EAASiD,SAASC,iBAAmBD,SAASE,MAE9ClD,EAAW,IAAImD,kBAAiB,SAACC,GACrCA,EAAahK,SAAQ,SAACiK,GACpBA,EAASC,WAAWlK,SAAQ,SAACJ,GAC3BD,EAAyCC,EAAM8G,EACjD,GACF,GACF,KAESyD,QAAQxD,EAAQ,CACvB4B,YAAY,EACZ6B,WAAW,EACXC,SAAS,IAGXrB,OAAOsB,iBAAiB,gBAAgB,WACtC1D,EAAS2D,YACX,IGnBM9D,EAA2B+D,QAAQjK,UAAU+J,iBAEnDE,QAAQjK,UAAU+J,iBAAmB,SACnCvI,EACA0I,GAEA,IAhBuCC,EAevCC,EAAUpB,UAAAvE,OAAA,QAAA4F,IAAArB,UAAA,IAAAA,UAAA,GAf6BmB,EAiBR3I,EAhBjCmF,QAAQC,MAAM,CACZpF,KAAM,8BACNqF,QAcyBJ,KAdRK,UACjBqD,UAAAA,IAcAjE,EAAyBxE,KAAK+E,KAAMjF,EAAM0I,EAAUE,EACtD","sources":["webpack://security-detection-methods/./client/utils.js","webpack://security-detection-methods/./client/detect-inline-script-injection.js","webpack://security-detection-methods/./client/detect-data-exfiltration.js","webpack://security-detection-methods/./client/detect-event-listeners.js"],"sourcesContent":["function recursivelySearchChildNodesForScriptNode(node, foundScriptCallback) {\n  if (node.nodeName === \"SCRIPT\") {\n    foundScriptCallback(node);\n  } else if (node.childNodes !== null) {\n    node.childNodes.forEach((childNode) => {\n      recursivelySearchChildNodesForScriptNode(childNode, foundScriptCallback);\n    });\n  }\n}\n\nexport function observeNewScriptNodesInDocument(foundScriptNodeCallback) {\n  const target = document.documentElement || document.body;\n\n  const observer = new MutationObserver((mutationList) => {\n    mutationList.forEach((mutation) => {\n      mutation.addedNodes.forEach((node) => {\n        recursivelySearchChildNodesForScriptNode(node, foundScriptNodeCallback);\n      });\n    });\n  });\n\n  observer.observe(target, {\n    attributes: true,\n    childList: true,\n    subtree: true,\n  });\n\n  window.addEventListener(\"beforeunload\", () => {\n    observer.disconnect();\n  });\n}\n","import { observeNewScriptNodesInDocument } from \"./utils\";\n\nconst LOG_URL = \"https://kashav.ca/cside/injected-scripts\";\n\n// Detects and reports inline-script injection. Also upload the content to an\n// endpoint via a beacon.\nexport function initInlineScriptInjectionDetection() {\n  observeNewScriptNodesInDocument(async (scriptNode) => {\n    let scriptContent = null;\n    let src = null;\n    let isExtensionScript = false;\n    let isInlineScript = false;\n\n    const srcAttr = scriptNode.attributes.getNamedItem(\"src\");\n    if (srcAttr) {\n      src = srcAttr.value;\n\n      // Fetch the content of the remote script.\n      const response = await fetch(src);\n      scriptContent = await response.text();\n\n      // Differentiate a client-side script injected by a browser extension from\n      // a script that was loaded as a result of the server side code.\n      isExtensionScript = !!src.match(/(chrome-extension|moz-extension)\\:\\/\\//);\n    } else if (scriptNode.childNodes?.[0]?.data) {\n      scriptContent = scriptNode.childNodes[0].data;\n      isInlineScript = true;\n    }\n\n    // Upload the script content.\n    if (scriptContent) {\n      console.table({\n        type: \"DETECTED_SCRIPT_INJECTION\",\n        src,\n        isInlineScript,\n        isExtensionScript,\n        scriptContent,\n      });\n\n      const payload = JSON.stringify({\n        href: window.location.href,\n        src: src || \"inline script\",\n        script: scriptContent,\n      });\n      const blob = new Blob([payload], { type: \"application/json\" });\n\n      try {\n        navigator.sendBeacon(LOG_URL, blob);\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  });\n}\n","function recordInputElementValueRead(inputElement, value) {\n  console.table({\n    type: \"DETECTED_DATA_EXFILTRATION\",\n    element: inputElement.outerHTML,\n    elementValue: value,\n  });\n}\n\n// Detect any data exfiltration attempts to common sensitive fields such as\n// credit card input fields, login credentials,\nexport function initDataExfiltrationDetection() {\n  const originalDescriptor = Object.getOwnPropertyDescriptor(\n    HTMLInputElement.prototype,\n    \"value\",\n  );\n\n  Object.defineProperty(HTMLInputElement.prototype, \"value\", {\n    get: function () {\n      const value = originalDescriptor.get.call(this);\n      // We can also inspect the input field and decide if this is a\n      // sensitive field based on various heuristics.\n      recordInputElementValueRead(this, value);\n      return value;\n    },\n    set: function (newValue) {\n      originalDescriptor.set.call(this, newValue);\n    },\n  });\n}\n","function recordEventListenerAdded(element, eventType) {\n  console.table({\n    type: \"DETECTED_NEW_EVENT_LISTENER\",\n    element: element.outerHTML,\n    eventType,\n  });\n}\n\n// Detect when javascript adds an event listener to a DOM item.\nexport function initEventListenerDetection() {\n  const originalAddEventListener = Element.prototype.addEventListener;\n\n  Element.prototype.addEventListener = function (\n    type,\n    listener,\n    useCapture = false,\n  ) {\n    recordEventListenerAdded(this, type);\n    originalAddEventListener.call(this, type, listener, useCapture);\n  };\n}\n"],"names":["recursivelySearchChildNodesForScriptNode","node","foundScriptCallback","nodeName","childNodes","forEach","childNode","_regeneratorRuntime","e","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","value","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","delegateYield","asyncGeneratorStep","originalDescriptor","originalAddEventListener","foundScriptNodeCallback","target","observer","getOwnPropertyDescriptor","HTMLInputElement","get","this","inputElement","console","table","element","outerHTML","elementValue","recordInputElementValueRead","set","newValue","_ref","_callee","scriptNode","_scriptNode$childNode","scriptContent","src","isExtensionScript","isInlineScript","srcAttr","response","payload","blob","_context","attributes","getNamedItem","fetch","text","match","data","JSON","stringify","href","window","location","script","Blob","navigator","sendBeacon","error","arguments","apply","_next","_throw","_x","document","documentElement","body","MutationObserver","mutationList","mutation","addedNodes","observe","childList","subtree","addEventListener","disconnect","Element","listener","eventType","useCapture","undefined"],"sourceRoot":""}